!function(){"use strict";angular.module("rateApp.rate-people.detail",[])}(),function(){"use strict";function e(e,t,r,n,i,a,o){function s(){function s(){return i.getPerson(e.userid).then(function(t){return R.person=t,R.person&&R.person!=={}?R.person:a.getData(o.assets.ASSETS_DATA+"/personajes.json").then(function(t){for(var r,n=0;n<t.length;n++)if(r=t[n],r._id===e.userid)return R.person=r,R.person})})}function u(){return n.getReviews(e.userid).then(function(t){return R.reviews=t,R.reviews&&0!==R.reviews.length?R.reviews:a.getData(o.assets.ASSETS_DATA+"/valoraciones.json").then(function(t){for(var r,n=[],i=0;i<t.length;i++)r=t[i],r.personId===e.userid&&n.push(r);return R.reviews=n,R.reviews})})}t.$emit("startLoading","RateDetailController");var c=[s(),u()];return r.all(c).then(function(){l(),t.$emit("endLoading","RateDetailController")})}function l(){d(),function(){$("#input-star-readonly").rating({size:"xs"}),$("#input-star-edit").rating({size:"xs"}),$("#input-star-edit").on("rating.change",function(e,t){R.review.stars=t,$("#input-star-readonly").rating("update",t)})}()}function u(){$("#myModal").modal("toggle")}function c(){R.review.personId=e.userid,R.review.createDate=Date.now(),n.addReview(R.review).then(function(e){e?(R.reviews.push(e),w("OK!","Review added successfully")):g("Error!","Review not added. ")})["catch"](function(e){g("Error!","Review not added. "+e)}),d(),$("#myModal").modal("toggle")}function d(){R.review={stars:0,description:"",personId:""},$("#input-star-edit").rating("reset"),$("#input-star-readonly").rating("reset")}function v(){d()}function p(){var e=event.target.id;n.deleteReview(e).then(function(){for(var t=0;t<R.reviews.length;t++)if(R.reviews[t]._id===e){R.reviews.splice(t,1),w("OK!","Review removed successfully");break}})["catch"](function(e){g("Error!","Review not removed. "+e)})}function f(){return R.reviews&&R.reviews.length>0}function w(e,r){var n={status:"OK",state:e,message:r};t.$emit("validation",n)}function g(e,r){var n={status:"ERROR",state:e,message:r};t.$emit("validation",n)}var R=this;R.validation={},R.person={},R.reviews=[],R.openReview=u,R.addReview=c,R.cancelReview=v,R.deleteReview=p,R.hasReviews=f,s()}angular.module("rateApp.rate-people.detail").controller("RateDetailController",e),e.$inject=["$stateParams","$scope","$q","ReviewService","PeopleService","DataService","RateAssets"]}(),function(){"use strict";function e(){return{restrict:"E",controller:"RateDetailController",controllerAs:"rateDetailCtrl",templateUrl:"src/rate-people-detail/rate-detail.template.html",link:t}}function t(e,t,r){var n=e,i=t,a=r;n&&i&&(a||(n=i))}angular.module("rateApp.rate-people.detail").directive("rateDetail",e),t.$inject=["$scope","$element","$attributes"]}();